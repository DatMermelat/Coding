function [x,numIter] = GaussSeidel(x0,A,b,maxIter,Tol)

% Solves Ax = b by Gauss-Seidel method.
% USAGE: [x,numIter] = gaussSeidel(x0,A,b,maxIter,Tol)

% INPUT:
%   x0 = starting solution vector
%   A = System Array
%   b = independent vector
%   maxIter = allowable number of iterations (default is 500)
%   Tol = error tolerance (default is 1.0e-9)
% OUTPUT:
%   x = solution vector
%   numIter = number of iterations carried out

if nargin < 5; Tol = 1.0e-9; end
if nargin < 4; maxIter = 500; end

% Size of the system
n = length(x0);

x = x0;

for numIter = 1:maxIter
    
  xOld = x;
  for i = 1:n
      sum = b(i) - A(i,1:i-1)*x(1:i-1);
      sum = sum - A(i,i+1:end)*xOld(i+1:end);
      x(i) = sum / A(i,i);
  end
  NormIt = norm(x - xOld,Inf);
  
  if NormIt < Tol; return; end
  
  if numIter == maxIter; end

end
error('Too many iterations')